- name: Run install bitwarden.sh with SSL mode set to "provided"
  expect:
    command: ./bitwarden.sh install
    responses: {{ bitwarden_install_inputs[bitwarden_ssl_mode] }}
    creates: bwdata/config.yml
  register: bw_install
  args:
    chdir: "{{ bitwarden_user_home }}"
  become_user: "{{ bitwarden_user }}"
  become: true

- name: Debug output
  debug:
    var: bw_install
    verbosity: 1

- name: Check install command output
  assert:
    that: "'Installation complete' in bw_install.stdout"
